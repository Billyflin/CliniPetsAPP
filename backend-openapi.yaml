openapi: 3.1.0
info:
  title: CliniPets API
  description: "## API REST para la plataforma CliniPets\n\nCliniPets es una plataforma\
    \ integral de gestión veterinaria que conecta a dueños de mascotas \ncon veterinarios\
    \ profesionales para servicios a domicilio y en clínica.\n\n### Características\
    \ principales:\n\n- **Autenticación**: Login con Google OAuth2 + JWT\n- **Gestió\
    n de Mascotas**: Registro y seguimiento de mascotas\n- **Catálogo**: Procedimientos\
    \ veterinarios y ofertas comerciales\n- **Reservas**: Sistema completo de agendamiento\
    \ de citas\n- **Disponibilidad**: Gestión de horarios de veterinarios\n- **Juntas\
    \ en Tiempo Real**: Tracking GPS de citas a domicilio\n- **Descubrimiento**: Bú\
    squeda geolocalizada de servicios\n- **Herramientas Clínicas**: Asistencia con\
    \ IA para diagnóstico y tratamiento\n- **WebSocket**: Actualizaciones en tiempo\
    \ real para juntas\n\n### Autenticación\n\nLa mayoría de los endpoints requieren\
    \ autenticación mediante JWT (JSON Web Token).\n\n**Flujo de autenticación:**\n\
    1. Obtener un Google ID Token desde el cliente\n2. Intercambiarlo por un JWT de\
    \ CliniPets usando `POST /api/auth/google`\n3. Incluir el JWT en el header `Authorization:\
    \ Bearer {token}` en cada petición\n\n/google-login.html\n\n### Roles de usuario\n\
    \n- **CLIENTE**: Dueños de mascotas (pueden gestionar mascotas y crear reservas)\n\
    - **VETERINARIO**: Profesionales veterinarios (gestión de agenda, juntas, herramientas\
    \ clínicas)\n- **ADMIN**: Administradores del sistema (acceso completo)\n\n###\
    \ WebSocket\n\nAdemás de la API REST, el sistema ofrece comunicación en tiempo\
    \ real vía WebSocket:\n- **Endpoint**: `ws://localhost:8080/ws`\n- **Protocolo**:\
    \ STOMP sobre WebSocket\n- **Destinos**: `/topic/juntas/{juntaId}` para seguimiento\
    \ de citas\n\n### Modelo de datos\n\nEl sistema sigue principios de Domain-Driven\
    \ Design (DDD) con contextos delimitados:\n- **Identidad**: Usuarios, roles y\
    \ autenticación\n- **Mascotas**: Gestión de mascotas y sus datos\n- **Catálogo**:\
    \ Procedimientos y ofertas\n- **Agenda**: Reservas, disponibilidad y juntas\n\
    - **Veterinarios**: Perfil y gestión de veterinarios\n- **Descubrimiento**: Bú\
    squeda y exploración\n- **Clínica**: Herramientas profesionales\n\n### Versionamiento\n\
    \nLa API utiliza versionamiento semántico. La versión actual es **1.0.0**.\n\n\
    ### Códigos de estado HTTP\n\n- **200 OK**: Petición exitosa\n- **201 Created**:\
    \ Recurso creado exitosamente\n- **204 No Content**: Operación exitosa sin contenido\
    \ de respuesta\n- **400 Bad Request**: Datos inválidos o petición malformada\n\
    - **401 Unauthorized**: No autenticado o token inválido\n- **403 Forbidden**:\
    \ Autenticado pero sin permisos suficientes\n- **404 Not Found**: Recurso no encontrado\n\
    - **500 Internal Server Error**: Error del servidor"
  contact:
    name: Equipo CliniPets
    url: https://clinipets.cl
    email: soporte@clinipets.cl
  license:
    name: Propietario
    url: https://clinipets.cl/licencia
  version: 1.0.0
servers:
  - url: http://localhost:8080
    description: Servidor de Desarrollo
  - url: https://clinipets.cl
    description: Servidor de Producción
security:
  - bearerAuth: []
tags:
  - name: Herramientas Clínicas
    description: Asistencia clínica inteligente para veterinarios (IA/ML)
  - name: Autenticación
    description: Endpoints de autenticación y gestión de sesión
  - name: Descubrimiento
    description: Búsqueda geo-localizada de servicios
  - name: Mascotas
    description: Gestión de mascotas del usuario
paths:
  /api/veterinarios/{id}/verificar:
    put:
      tags:
        - Veterinarios
      operationId: verificar
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: OK
          content:
            '*/*':
              schema:
                $ref: "#/components/schemas/Veterinario"
  /api/veterinarios/mi-perfil:
    get:
      tags:
        - Veterinarios
      operationId: miPerfil
      responses:
        "200":
          description: OK
          content:
            '*/*':
              schema:
                $ref: "#/components/schemas/Veterinario"
    put:
      tags:
        - Veterinarios
      operationId: actualizarMiPerfil
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/VeterinarioDto"
        required: true
      responses:
        "200":
          description: OK
          content:
            '*/*':
              schema:
                $ref: "#/components/schemas/Veterinario"
  /api/veterinarios/mi-catalogo:
    get:
      tags:
        - Veterinarios
      operationId: miCatalogo
      responses:
        "200":
          description: OK
          content:
            '*/*':
              schema:
                $ref: "#/components/schemas/CatalogoVeterinario"
    put:
      tags:
        - Veterinarios
      operationId: actualizarMiCatalogo
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CatalogoVeterinarioDTO"
        required: true
      responses:
        "200":
          description: OK
          content:
            '*/*':
              schema:
                $ref: "#/components/schemas/CatalogoVeterinario"
  /api/mascotas/{id}:
    get:
      tags:
        - Mascotas
      summary: Detalle de mascota
      description: "\n            Obtiene los detalles completos de una mascota por\
        \ su ID.\n            Solo accesible por el propietario o usuarios con rol\
        \ ADMIN.\n        "
      operationId: detalleMascota
      parameters:
        - name: id
          in: path
          description: UUID de la mascota
          required: true
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: Detalle obtenido exitosamente
          content:
            '*/*':
              schema:
                $ref: "#/components/schemas/Mascota"
        "403":
          description: Acceso denegado - no es el propietario
          content:
            '*/*':
              schema:
                $ref: "#/components/schemas/ProblemDetail"
        "404":
          description: Mascota no encontrada
          content:
            '*/*':
              schema:
                $ref: "#/components/schemas/ProblemDetail"
      security:
        - bearerAuth: []
    put:
      tags:
        - Mascotas
      summary: Actualizar datos de mascota
      description: "Actualiza información básica de la mascota (nombre, raza, peso,\
        \ etc.)."
      operationId: actualizarMascota
      parameters:
        - name: id
          in: path
          description: UUID de la mascota
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ActualizarMascota"
        required: true
      responses:
        "200":
          description: Mascota actualizada exitosamente
          content:
            '*/*':
              schema:
                $ref: "#/components/schemas/Mascota"
        "403":
          description: Acceso denegado - no es el propietario
          content:
            '*/*':
              schema:
                $ref: "#/components/schemas/ProblemDetail"
        "404":
          description: Mascota no encontrada
          content:
            '*/*':
              schema:
                $ref: "#/components/schemas/ProblemDetail"
      security:
        - bearerAuth: []
    delete:
      tags:
        - Mascotas
      summary: Eliminar mascota
      description: Elimina una mascota del sistema. Solo el propietario puede realizar
        esta acción.
      operationId: eliminarMascota
      parameters:
        - name: id
          in: path
          description: UUID de la mascota
          required: true
          schema:
            type: string
            format: uuid
      responses:
        "204":
          description: Mascota eliminada exitosamente
        "403":
          description: Acceso denegado - no es el propietario
          content:
            '*/*':
              schema:
                $ref: "#/components/schemas/ProblemDetail"
        "404":
          description: Mascota no encontrada
          content:
            '*/*':
              schema:
                $ref: "#/components/schemas/ProblemDetail"
      security:
        - bearerAuth: []
  /api/veterinarios:
    post:
      tags:
        - Veterinarios
      summary: Registrar/activar cuenta de veterinario (onboarding)
      operationId: registrar
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/VeterinarioDto"
        required: true
      responses:
        "200":
          description: OK
          content:
            '*/*':
              schema:
                $ref: "#/components/schemas/Veterinario"
  /api/mascotas:
    post:
      tags:
        - Mascotas
      summary: Registrar nueva mascota
      description: "\n            Crea una nueva mascota asociada al usuario autenticado.\n\
        \            La mascota incluye información como nombre, especie, raza, fecha\
        \ de nacimiento, etc.\n        "
      operationId: crearMascota
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CrearMascota"
        required: true
      responses:
        "201":
          description: Mascota creada exitosamente
          content:
            '*/*':
              schema:
                $ref: "#/components/schemas/Mascota"
        "400":
          description: Datos inválidos
          content:
            '*/*':
              schema:
                $ref: "#/components/schemas/ProblemDetail"
        "401":
          description: No autenticado
          content:
            '*/*':
              schema:
                $ref: "#/components/schemas/ProblemDetail"
      security:
        - bearerAuth: []
  /api/mascotas/razas:
    post:
      tags:
        - Mascotas
      summary: Buscar razas
      description: "Devuelve una lista de razas, filtrada por los criterios del cuerpo\
        \ JSON."
      operationId: buscarRazas
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ListarRazasRequest"
        required: true
      responses:
        "200":
          description: Lista de razas obtenida exitosamente
          content:
            '*/*':
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Raza"
      security:
        - bearerAuth: []
  /api/horarios:
    get:
      tags:
        - horarios-controller
      operationId: listarHorariosVet
      responses:
        "200":
          description: OK
          content:
            '*/*':
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/HorarioAtencion"
    post:
      tags:
        - horarios-controller
      operationId: crearHorarioVet
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/HorarioAtencion"
        required: true
      responses:
        "200":
          description: OK
          content:
            '*/*':
              schema:
                $ref: "#/components/schemas/HorarioAtencion"
  /api/horarios/excepciones:
    get:
      tags:
        - horarios-controller
      operationId: listarExcepcionesVet
      responses:
        "200":
          description: OK
          content:
            '*/*':
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/ExcepcionHorario"
    post:
      tags:
        - horarios-controller
      operationId: crearExcepcionVet
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ExcepcionHorario"
        required: true
      responses:
        "200":
          description: OK
          content:
            '*/*':
              schema:
                $ref: "#/components/schemas/ExcepcionHorario"
  /api/horarios/clinica:
    get:
      tags:
        - horarios-controller
      operationId: listarHorariosClinica
      responses:
        "200":
          description: OK
          content:
            '*/*':
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/HorarioAtencion"
    post:
      tags:
        - horarios-controller
      operationId: crearHorarioClinica
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/HorarioAtencion"
        required: true
      responses:
        "200":
          description: OK
          content:
            '*/*':
              schema:
                $ref: "#/components/schemas/HorarioAtencion"
  /api/horarios/clinica/excepciones:
    get:
      tags:
        - horarios-controller
      operationId: listarExcepcionesClinica
      responses:
        "200":
          description: OK
          content:
            '*/*':
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/ExcepcionHorario"
    post:
      tags:
        - horarios-controller
      operationId: crearExcepcionClinica
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ExcepcionHorario"
        required: true
      responses:
        "200":
          description: OK
          content:
            '*/*':
              schema:
                $ref: "#/components/schemas/ExcepcionHorario"
  /api/descubrimiento/buscar:
    post:
      tags:
        - Descubrimiento
      summary: Buscar veterinarios por servicio y ubicación
      description: "\n            Realiza una búsqueda filtrada de veterinarios.\n\
        \            1. Filtra por compatibilidad de servicio y especie.\n       \
        \     2. Filtra por modo de atención (Domicilio o Clínica).\n            3.\
        \ Filtra geográficamente (radio de cobertura o cercanía).\n        "
      operationId: buscarDescubrimiento
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/DiscoveryRequest"
        required: true
      responses:
        "200":
          description: OK
          content:
            '*/*':
              schema:
                type: object
      security:
        - bearerAuth: []
  /api/clinica/sugerencias/tratamiento:
    post:
      tags:
        - Herramientas Clínicas
      summary: Obtener recomendaciones de tratamiento
      description: "\n            Proporciona recomendaciones de tratamiento para\
        \ un diagnóstico específico.\n            Incluye sugerencias de medicació\
        n, procedimientos y cuidados.\n            \n            **Requiere rol:**\
        \ VETERINARIO o ADMIN\n            \n            **Nota:** Esta es una herramienta\
        \ de asistencia. El plan de tratamiento final es responsabilidad del veterinario.\n\
        \        "
      operationId: obtenerRecomendacionesTratamiento
      requestBody:
        description: Diagnóstico establecido
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/RecomendacionesTratamientoRequest"
            example:
              diagnostico: Gastroenteritis aguda
        required: true
      responses:
        "200":
          description: Recomendaciones generadas exitosamente
          content:
            application/json:
              example:
                - Fluidoterapia
                - Dieta blanda
                - Antiemético (Metoclopramida)
                - Protector gástrico
        "400":
          description: Diagnóstico vacío o inválido
          content:
            '*/*':
              schema:
                type: array
                items:
                  type: string
        "403":
          description: Sin permisos - requiere rol VETERINARIO o ADMIN
          content:
            '*/*':
              schema:
                type: array
                items:
                  type: string
      security:
        - bearerAuth: []
  /api/clinica/sugerencias/diagnostico:
    post:
      tags:
        - Herramientas Clínicas
      summary: Obtener sugerencias de diagnóstico
      description: "\n            Proporciona sugerencias de diagnósticos posibles\
        \ basados en una lista de síntomas observados.\n            Utiliza modelos\
        \ de IA/ML para asistir al veterinario (no reemplaza el criterio profesional).\n\
        \            \n            **Requiere rol:** VETERINARIO o ADMIN\n       \
        \     \n            **Nota:** Esta es una herramienta de asistencia. El diagnó\
        stico final es responsabilidad del veterinario.\n        "
      operationId: obtenerSugerenciasDiagnostico
      requestBody:
        description: Síntomas observados en el paciente
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/SugerenciasDiagnosticoRequest"
            example:
              sintomas:
                - fiebre
                - tos
                - estornudos
                - secreción nasal
        required: true
      responses:
        "200":
          description: Sugerencias generadas exitosamente
          content:
            application/json:
              example:
                - Infección respiratoria superior
                - Tos de las perreras
                - Influenza canina
        "400":
          description: Lista de síntomas vacía o inválida
          content:
            '*/*':
              schema:
                type: array
                items:
                  type: string
        "403":
          description: Sin permisos - requiere rol VETERINARIO o ADMIN
          content:
            '*/*':
              schema:
                type: array
                items:
                  type: string
      security:
        - bearerAuth: []
  /api/auth/refresh:
    post:
      tags:
        - Autenticación
      summary: Refrescar sesión
      description: Lee el refresh token de la cookie HttpOnly y entrega un nuevo access
        token (y rota el refresh).
      operationId: authRefresh
      responses:
        "200":
          description: Token rotado correctamente
          content:
            '*/*':
              schema:
                $ref: "#/components/schemas/RefreshResponse"
        "401":
          description: "Refresh token ausente, inválido o expirado"
          content:
            '*/*':
              schema:
                $ref: "#/components/schemas/ErrorResponse"
      security:
        - bearerAuth: []
  /api/auth/logout:
    post:
      tags:
        - Autenticación
      summary: Cerrar sesión
      description: Elimina la cookie de refresh y cierra la sesión en el cliente.
      operationId: authLogout
      responses:
        "200":
          description: Sesión cerrada correctamente
          content:
            '*/*':
              schema:
                type: object
                additionalProperties: {}
  /api/auth/google:
    post:
      tags:
        - Autenticación
      summary: Autenticación con Google
      description: "\n            Autentica un usuario mediante Google Sign-In. \n\
        \            Intercambia un Google ID Token válido por un JWT propio del sistema.\n\
        \            Si el usuario no existe, se crea automáticamente.\n         \
        \   También emite un refresh token en cookie HttpOnly.\n        "
      operationId: authLoginGoogle
      requestBody:
        description: Token de Google emitido por el cliente
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/GoogleLoginRequest"
            examples:
              LoginGoogle:
                summary: Petición con ID Token válido
                description: LoginGoogle
                value:
                  idToken: eyJhbGciOiJSUzI1NiIsImtpZCI6...
        required: true
      responses:
        "200":
          description: Autenticación exitosa
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/LoginResponse"
        "400":
          description: Token mal formado
          content:
            '*/*':
              schema:
                $ref: "#/components/schemas/ProblemDetail"
        "401":
          description: Token de Google inválido o expirado
          content:
            '*/*':
              schema:
                $ref: "#/components/schemas/ProblemDetail"
  /api/agenda/reservas:
    post:
      tags:
        - agenda-controller
      operationId: crearReserva
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ReservaCreateDTO"
        required: true
      responses:
        "200":
          description: OK
          content:
            '*/*':
              schema:
                $ref: "#/components/schemas/Reserva"
  /api/agenda/reservas/confirmar:
    post:
      tags:
        - agenda-controller
      operationId: confirmar
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ReservaAccionRequest"
        required: true
      responses:
        "200":
          description: OK
          content:
            '*/*':
              schema:
                $ref: "#/components/schemas/Reserva"
  /api/agenda/reservas/cancelar:
    post:
      tags:
        - agenda-controller
      operationId: cancelar
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ReservaAccionRequest"
        required: true
      responses:
        "200":
          description: OK
          content:
            '*/*':
              schema:
                $ref: "#/components/schemas/Reserva"
  /api/agenda/mis-reservas:
    post:
      tags:
        - agenda-controller
      operationId: misReservas
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/MisReservasQuery"
        required: true
      responses:
        "200":
          description: OK
          content:
            '*/*':
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Reserva"
  /api/veterinarios/procedimientos:
    get:
      tags:
        - Veterinarios
      operationId: listarProcedimientos
      responses:
        "200":
          description: OK
          content:
            '*/*':
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Procedimiento"
  /api/mascotas/mias:
    get:
      tags:
        - Mascotas
      summary: Listar mis mascotas
      description: Devuelve todas las mascotas registradas del usuario autenticado.
      operationId: listarMisMascotas
      responses:
        "200":
          description: Lista de mascotas obtenida exitosamente
          content:
            '*/*':
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Mascota"
        "401":
          description: No autenticado
          content:
            '*/*':
              schema:
                $ref: "#/components/schemas/ProblemDetail"
      security:
        - bearerAuth: []
  /api/horarios/slots:
    get:
      tags:
        - horarios-controller
      operationId: slots
      parameters:
        - name: tipo
          in: query
          required: true
          schema:
            type: string
            enum:
              - VETERINARIO
              - CLINICA
        - name: fecha
          in: query
          required: true
          schema:
            type: string
            format: date
        - name: procedimientoSku
          in: query
          required: true
          schema:
            type: string
        - name: ownerId
          in: query
          required: false
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: OK
          content:
            '*/*':
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Intervalo"
  /api/horarios/disponibilidad:
    get:
      tags:
        - horarios-controller
      operationId: disponibilidad
      parameters:
        - name: tipo
          in: query
          required: true
          schema:
            type: string
            enum:
              - VETERINARIO
              - CLINICA
        - name: fecha
          in: query
          required: true
          schema:
            type: string
            format: date
        - name: ownerId
          in: query
          required: false
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: OK
          content:
            '*/*':
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Intervalo"
  /api/auth/me:
    get:
      tags:
        - Autenticación
      summary: Obtener perfil actual
      description: "\n            Devuelve información básica del usuario autenticado.\n\
        \            Si no hay token o es inválido, devuelve authenticated=false.\n\
        \        "
      operationId: authMe
      responses:
        "200":
          description: Perfil obtenido exitosamente
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/MeResponse"
      security:
        - bearerAuth: []
  /api/horarios/{horarioId}:
    delete:
      tags:
        - horarios-controller
      operationId: eliminarHorarioVet
      parameters:
        - name: horarioId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: OK
  /api/horarios/excepciones/{excepcionId}:
    delete:
      tags:
        - horarios-controller
      operationId: eliminarExcepcionVet
      parameters:
        - name: excepcionId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: OK
  /api/horarios/clinica/{horarioId}:
    delete:
      tags:
        - horarios-controller
      operationId: eliminarHorarioClinica
      parameters:
        - name: horarioId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: OK
  /api/horarios/clinica/excepciones/{excepcionId}:
    delete:
      tags:
        - horarios-controller
      operationId: eliminarExcepcionClinica
      parameters:
        - name: excepcionId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: OK
components:
  schemas:
    Veterinario:
      type: object
      description: Entidad que representa al profesional veterinario dentro de la
        plataforma.
      properties:
        id:
          type: string
          format: uuid
          readOnly: true
        nombreCompleto:
          type: string
        numeroLicencia:
          type: string
        estado:
          type: string
          description: Estado operativo del veterinario en la plataforma.
          enum:
            - ONLINE
            - OCUPADO
            - OFFLINE
        modosAtencion:
          type: array
          items:
            type: string
            description: Modalidades de atención que puede ofrecer el veterinario.
            enum:
              - DOMICILIO
              - CLINICA
              - URGENCIA
          uniqueItems: true
        latitud:
          type: number
          format: double
        longitud:
          type: number
          format: double
        radioCobertura:
          type: number
          format: double
        verificado:
          type: boolean
          readOnly: true
        ofreceLogistica:
          type: boolean
          description: Indica si ofrece logística (retiro/entrega de la mascota)
          example: false
        creadoEn:
          type: string
          format: date-time
          description: Fecha de creación del registro
          example: 2025-11-14T12:34:56Z
          readOnly: true
        modificadoEn:
          type: string
          format: date-time
          description: Fecha de última modificación del registro
          example: 2025-11-14T12:34:56Z
          readOnly: true
        creadoPor:
          type: string
          format: uuid
          description: Identificador del usuario que creó el registro
          readOnly: true
        modificadoPor:
          type: string
          format: uuid
          description: Identificador del usuario que modificó el registro
          readOnly: true
      required:
        - creadoEn
        - estado
        - modificadoEn
        - modosAtencion
        - nombreCompleto
    VeterinarioDto:
      type: object
      properties:
        nombreCompleto:
          type: string
        numeroLicencia:
          type: string
        estado:
          type: string
          description: Estado operativo del veterinario en la plataforma.
          enum:
            - ONLINE
            - OCUPADO
            - OFFLINE
        modosAtencion:
          type: array
          items:
            type: string
            description: Modalidades de atención que puede ofrecer el veterinario.
            enum:
              - DOMICILIO
              - CLINICA
              - URGENCIA
          uniqueItems: true
        latitud:
          type: number
          format: double
        longitud:
          type: number
          format: double
        radioCobertura:
          type: number
          format: double
        ofreceLogistica:
          type: boolean
      required:
        - estado
        - modosAtencion
        - nombreCompleto
    CatalogoVeterinarioDTO:
      type: object
      description: DTO de salida del catálogo del veterinario
      properties:
        id:
          type: string
          format: uuid
          description: ID del catálogo (igual al veterinario)
        items:
          type: array
          description: Items del catálogo
          items:
            $ref: "#/components/schemas/ItemCatalogoDTO"
      required:
        - items
    ItemCatalogoDTO:
      type: object
      description: DTO de un ítem del catálogo
      properties:
        procedimientoSku:
          type: string
          description: SKU del procedimiento
        nombreProcedimiento:
          type: string
          description: Nombre del procedimiento
        habilitado:
          type: boolean
          description: Visible para clientes
        precioOverride:
          type: integer
          format: int32
          description: Precio override si existe
        duracionMinutosOverride:
          type: integer
          format: int32
          description: Duración override si existe
      required:
        - habilitado
        - nombreProcedimiento
        - procedimientoSku
    CatalogoVeterinario:
      type: object
      description: Catálogo de procedimientos que cada veterinario ofrece a los clientes.
      properties:
        items:
          type: array
          description: Listado de procedimientos configurados por el veterinario.
          items:
            $ref: "#/components/schemas/ItemCatalogo"
          uniqueItems: true
        creadoEn:
          type: string
          format: date-time
          description: Fecha de creación del registro
          example: 2025-11-14T12:34:56Z
          readOnly: true
        modificadoEn:
          type: string
          format: date-time
          description: Fecha de última modificación del registro
          example: 2025-11-14T12:34:56Z
          readOnly: true
        creadoPor:
          type: string
          format: uuid
          description: Identificador del usuario que creó el registro
          readOnly: true
        modificadoPor:
          type: string
          format: uuid
          description: Identificador del usuario que modificó el registro
          readOnly: true
      required:
        - creadoEn
        - modificadoEn
    ItemCatalogo:
      type: object
      description: Configuración individual de un procedimiento dentro del catálogo
        del veterinario.
      properties:
        id:
          $ref: "#/components/schemas/ItemCatalogoId"
          description: Identificador compuesto del ítem.
        procedimiento:
          $ref: "#/components/schemas/Procedimiento"
          description: Procedimiento base publicado en el catálogo.
        habilitado:
          type: boolean
          description: Indica si el procedimiento está visible para los clientes.
        precioOverride:
          type: integer
          format: int32
          description: Precio personalizado en CLP para este veterinario (opcional).
          example: 15000
        duracionMinutosOverride:
          type: integer
          format: int32
          description: Duración personalizada en minutos para este veterinario (opcional).
          example: 45
      required:
        - habilitado
        - id
        - procedimiento
    ItemCatalogoId:
      type: object
      description: Identificador compuesto que relaciona el catálogo con el procedimiento
        disponible.
      properties:
        catalogoId:
          type: string
          format: uuid
          description: ID del catálogo al que pertenece el procedimiento.
          readOnly: true
        procedimientoSku:
          type: string
          description: SKU del procedimiento que se expone en el catálogo.
          example: VAC-PARVO-001
    Procedimiento:
      type: object
      description: Procedimiento veterinario estándar ofrecido por la plataforma.
      properties:
        sku:
          type: string
          description: SKU único del procedimiento.
          example: VAC-PARVO-001
        nombre:
          type: string
          description: Nombre comercial del procedimiento.
          example: Vacuna Parvovirus Puppy
        descripcion:
          type: string
          description: Descripción resumida del procedimiento.
        precio:
          type: integer
          format: int32
          description: Precio de referencia en CLP.
          example: 25000
        compatibleCon:
          type: array
          description: Especies compatibles para el procedimiento.
          items:
            type: string
            enum:
              - PERRO
              - GATO
          uniqueItems: true
        modosHabilitados:
          type: array
          description: Modos de atención soportados por el procedimiento.
          items:
            type: string
            description: Modalidades de atención que puede ofrecer el veterinario.
            enum:
              - DOMICILIO
              - CLINICA
              - URGENCIA
          uniqueItems: true
        flujo:
          type: string
          description: Tipo de flujo logístico requerido para realizarlo.
          enum:
            - SIMPLE
            - LOGISTICA_COMPLETA
        duracionMinutos:
          type: integer
          format: int32
          description: Duración estimada del procedimiento en minutos.
          example: 30
        creadoEn:
          type: string
          format: date-time
          description: Fecha de creación del registro
          example: 2025-11-14T12:34:56Z
          readOnly: true
        modificadoEn:
          type: string
          format: date-time
          description: Fecha de última modificación del registro
          example: 2025-11-14T12:34:56Z
          readOnly: true
        creadoPor:
          type: string
          format: uuid
          description: Identificador del usuario que creó el registro
          readOnly: true
        modificadoPor:
          type: string
          format: uuid
          description: Identificador del usuario que modificó el registro
          readOnly: true
      required:
        - compatibleCon
        - creadoEn
        - duracionMinutos
        - flujo
        - modificadoEn
        - modosHabilitados
        - nombre
        - precio
        - sku
    ActualizarMascota:
      type: object
      properties:
        nombre:
          type: string
        razaId:
          type: string
          format: uuid
        sexo:
          type: string
          enum:
            - MACHO
            - HEMBRA
        fechaNacimiento:
          type: string
          format: date
        esFechaAproximada:
          type: boolean
        pesoKg:
          type: number
          format: double
        pelaje:
          type: string
          enum:
            - CORTO
            - MEDIO
            - LARGO
            - RIZADO
            - SIN_PELO
        patron:
          type: string
          enum:
            - SOLIDO
            - BICOLOR
            - TRICOLOR
            - TABBY
            - MANCHAS_MERLE
            - ATIGRADO_BRINDLE
        colores:
          type: array
          items:
            type: string
            enum:
              - NEGRO
              - BLANCO
              - GRIS
              - NARANJA_ROJIZO
              - CREMA
              - CAFE_CHOCOLATE
              - AZUL
              - DORADO
              - FUEGO_TAN
          uniqueItems: true
    ProblemDetail:
      type: object
      properties:
        type:
          type: string
          format: uri
        title:
          type: string
        status:
          type: integer
          format: int32
        detail:
          type: string
        instance:
          type: string
          format: uri
        properties:
          type: object
          additionalProperties: {}
    Mascota:
      type: object
      properties:
        id:
          type: string
          format: uuid
        nombre:
          type: string
        especie:
          type: string
          enum:
            - PERRO
            - GATO
        raza:
          $ref: "#/components/schemas/Raza"
        sexo:
          type: string
          enum:
            - MACHO
            - HEMBRA
        fechaNacimiento:
          type: string
          format: date
        esFechaAproximada:
          type: boolean
        pesoKg:
          type: number
          format: double
        pelaje:
          type: string
          enum:
            - CORTO
            - MEDIO
            - LARGO
            - RIZADO
            - SIN_PELO
        patron:
          type: string
          enum:
            - SOLIDO
            - BICOLOR
            - TRICOLOR
            - TABBY
            - MANCHAS_MERLE
            - ATIGRADO_BRINDLE
        colores:
          type: array
          items:
            type: string
            enum:
              - NEGRO
              - BLANCO
              - GRIS
              - NARANJA_ROJIZO
              - CREMA
              - CAFE_CHOCOLATE
              - AZUL
              - DORADO
              - FUEGO_TAN
          uniqueItems: true
        creadoEn:
          type: string
          format: date-time
          description: Fecha de creación del registro
          example: 2025-11-14T12:34:56Z
          readOnly: true
        modificadoEn:
          type: string
          format: date-time
          description: Fecha de última modificación del registro
          example: 2025-11-14T12:34:56Z
          readOnly: true
        creadoPor:
          type: string
          format: uuid
          description: Identificador del usuario que creó el registro
          readOnly: true
        modificadoPor:
          type: string
          format: uuid
          description: Identificador del usuario que modificó el registro
          readOnly: true
      required:
        - colores
        - creadoEn
        - esFechaAproximada
        - especie
        - modificadoEn
        - nombre
    Raza:
      type: object
      properties:
        id:
          type: string
          format: uuid
        nombre:
          type: string
        especie:
          type: string
          enum:
            - PERRO
            - GATO
      required:
        - especie
        - nombre
    CrearMascota:
      type: object
      properties:
        nombre:
          type: string
        especie:
          type: string
          enum:
            - PERRO
            - GATO
        razaId:
          type: string
          format: uuid
        sexo:
          type: string
          enum:
            - MACHO
            - HEMBRA
        fechaNacimiento:
          type: string
          format: date
        esFechaAproximada:
          type: boolean
        pesoKg:
          type: number
          format: double
        pelaje:
          type: string
          enum:
            - CORTO
            - MEDIO
            - LARGO
            - RIZADO
            - SIN_PELO
        patron:
          type: string
          enum:
            - SOLIDO
            - BICOLOR
            - TRICOLOR
            - TABBY
            - MANCHAS_MERLE
            - ATIGRADO_BRINDLE
        colores:
          type: array
          items:
            type: string
            enum:
              - NEGRO
              - BLANCO
              - GRIS
              - NARANJA_ROJIZO
              - CREMA
              - CAFE_CHOCOLATE
              - AZUL
              - DORADO
              - FUEGO_TAN
          uniqueItems: true
      required:
        - especie
        - nombre
    ListarRazasRequest:
      type: object
      properties:
        especie:
          type: string
          enum:
            - PERRO
            - GATO
    HorarioAtencion:
      type: object
      properties:
        id:
          type: string
          format: uuid
        tipoOwner:
          type: string
          enum:
            - VETERINARIO
            - CLINICA
        diaSemana:
          type: string
          enum:
            - MONDAY
            - TUESDAY
            - WEDNESDAY
            - THURSDAY
            - FRIDAY
            - SATURDAY
            - SUNDAY
        horaInicio:
          type: string
        horaFin:
          type: string
      required:
        - diaSemana
        - horaFin
        - horaInicio
        - tipoOwner
    ExcepcionHorario:
      type: object
      properties:
        id:
          type: string
          format: uuid
        tipoOwner:
          type: string
          enum:
            - VETERINARIO
            - CLINICA
        fecha:
          type: string
          format: date
        cerrado:
          type: boolean
        horaInicio:
          type: string
        horaFin:
          type: string
        motivo:
          type: string
      required:
        - cerrado
        - fecha
        - tipoOwner
    DiscoveryRequest:
      type: object
      properties:
        mascotaId:
          type: string
          format: uuid
        servicioSku:
          type: string
        modoAtencion:
          type: string
          description: Modalidades de atención que puede ofrecer el veterinario.
          enum:
            - DOMICILIO
            - CLINICA
            - URGENCIA
        latitud:
          type: number
          format: double
        longitud:
          type: number
          format: double
      required:
        - latitud
        - longitud
        - mascotaId
        - modoAtencion
        - servicioSku
    RecomendacionesTratamientoRequest:
      type: object
      description: Solicitud de recomendaciones de tratamiento para un diagnóstico
      properties:
        diagnostico:
          type: string
          description: Diagnóstico establecido
          example: Gastroenteritis aguda
      required:
        - diagnostico
    SugerenciasDiagnosticoRequest:
      type: object
      description: Solicitud de sugerencias de diagnóstico basadas en síntomas
      properties:
        sintomas:
          type: array
          description: Lista de síntomas observados
          example:
            - fiebre
            - vómitos
            - letargo
          items:
            type: string
      required:
        - sintomas
    RefreshResponse:
      type: object
      description: Respuesta tras rotar el token de acceso.
      properties:
        token:
          type: string
          description: Nuevo JWT de acceso
        expiresAt:
          type: string
          format: date-time
          description: Expiración del nuevo JWT de acceso
        usuario:
          $ref: "#/components/schemas/UsuarioInfo"
          description: Perfil del usuario autenticado
      required:
        - expiresAt
        - token
        - usuario
    UsuarioInfo:
      type: object
      description: Información del usuario autenticado expuesta al cliente.
      properties:
        id:
          type: string
          format: uuid
          description: Identificador del usuario
        email:
          type: string
          format: email
          description: Email verificado del usuario
        nombre:
          type: string
          description: Nombre visible del usuario
        fotoUrl:
          type: string
          description: URL del avatar o foto del usuario
        roles:
          type: array
          description: Roles otorgados al usuario
          example:
            - CLIENTE
          items:
            type: string
      required:
        - email
        - id
        - roles
    ErrorResponse:
      type: object
      description: Respuesta estándar de error.
      properties:
        error:
          type: string
          description: Mensaje legible del error
      required:
        - error
    GoogleLoginRequest:
      type: object
      description: Payload enviado por el cliente móvil luego de autenticarse con
        Google Sign-In.
      example:
        idToken: eyJhbGciOiJSUzI1NiIsImtpZCI6InNvbWUta2V5In0...
      properties:
        idToken:
          type: string
          description: ID Token de Google con email verificado
      required:
        - idToken
    LoginResponse:
      type: object
      description: Respuesta devuelta tras un login exitoso.
      properties:
        token:
          type: string
          description: JWT de acceso emitido por el backend
        expiresAt:
          type: string
          format: date-time
          description: Expiración del JWT de acceso
        refreshExpiresAt:
          type: string
          format: date-time
          description: Expiración del refresh token
        usuario:
          $ref: "#/components/schemas/UsuarioInfo"
          description: Perfil del usuario autenticado
      required:
        - expiresAt
        - token
        - usuario
    ReservaCreateDTO:
      type: object
      properties:
        procedimientoSku:
          type: string
        modoAtencion:
          type: string
          description: Modalidades de atención que puede ofrecer el veterinario.
          enum:
            - DOMICILIO
            - CLINICA
            - URGENCIA
        fecha:
          type: string
          format: date
        horaInicio:
          type: string
        veterinarioId:
          type: string
          format: uuid
        direccionTexto:
          type: string
        lat:
          type: number
          format: double
        lng:
          type: number
          format: double
        referencias:
          type: string
      required:
        - fecha
        - horaInicio
        - modoAtencion
        - procedimientoSku
    Reserva:
      type: object
      properties:
        id:
          type: string
          format: uuid
        clienteId:
          type: string
          format: uuid
        veterinarioId:
          type: string
          format: uuid
        clinicaId:
          type: string
          format: uuid
        procedimientoSku:
          type: string
        precio:
          type: number
        duracionMinutosSnapshot:
          type: integer
          format: int32
        fecha:
          type: string
          format: date
        horaInicio:
          type: string
        horaFin:
          type: string
        modoAtencion:
          type: string
          description: Modalidades de atención que puede ofrecer el veterinario.
          enum:
            - DOMICILIO
            - CLINICA
            - URGENCIA
        direccionTexto:
          type: string
        lat:
          type: number
          format: double
        lng:
          type: number
          format: double
        referencias:
          type: string
        estado:
          type: string
          enum:
            - PENDIENTE
            - CONFIRMADA
            - CANCELADA_CLIENTE
            - CANCELADA_VETERINARIO
            - CANCELADA_CLINICA
            - REALIZADA
      required:
        - clienteId
        - duracionMinutosSnapshot
        - estado
        - fecha
        - horaFin
        - horaInicio
        - modoAtencion
        - precio
        - procedimientoSku
    ReservaAccionRequest:
      type: object
      properties:
        reservaId:
          type: string
          format: uuid
      required:
        - reservaId
    MisReservasQuery:
      type: object
      properties:
        como:
          type: array
          items:
            type: string
            enum:
              - CLIENTE
              - VETERINARIO
        fecha:
          type: string
          format: date
        estados:
          type: array
          items:
            type: string
            enum:
              - PENDIENTE
              - CONFIRMADA
              - CANCELADA_CLIENTE
              - CANCELADA_VETERINARIO
              - CANCELADA_CLINICA
              - REALIZADA
        modos:
          type: array
          items:
            type: string
            description: Modalidades de atención que puede ofrecer el veterinario.
            enum:
              - DOMICILIO
              - CLINICA
              - URGENCIA
    Intervalo:
      type: object
      properties:
        inicio:
          type: string
        fin:
          type: string
      required:
        - fin
        - inicio
    MeResponse:
      type: object
      description: Respuesta al consultar el perfil actual.
      properties:
        authenticated:
          type: boolean
          description: Indica si existe una sesión autenticada
        id:
          type: string
          format: uuid
          description: Identificador del usuario autenticado
        email:
          type: string
          description: Email asociado a la sesión
        roles:
          type: array
          description: Roles activos del usuario
          items:
            type: string
        nombre:
          type: string
          description: Nombre visible del usuario
        fotoUrl:
          type: string
          description: URL del avatar o foto del usuario
      required:
        - authenticated
  securitySchemes:
    bearerAuth:
      type: http
      description: JWT obtenido mediante autenticación con Google
      scheme: bearer
      bearerFormat: JWT
