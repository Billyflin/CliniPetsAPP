openapi: 3.1.0
info:
  title: CliniPets API
  description: "## API REST para la plataforma CliniPets\n\nCliniPets es una plataforma\
    \ integral de gestión veterinaria que conecta a dueños de mascotas \ncon veterinarios\
    \ profesionales para servicios a domicilio y en clínica.\n\n### Características\
    \ principales:\n\n- **Autenticación**: Login con Google OAuth2 + JWT\n- **Gestió\
    n de Mascotas**: Registro y seguimiento de mascotas\n- **Catálogo**: Procedimientos\
    \ veterinarios y ofertas comerciales\n- **Reservas**: Sistema completo de agendamiento\
    \ de citas\n- **Disponibilidad**: Gestión de horarios de veterinarios\n- **Juntas\
    \ en Tiempo Real**: Tracking GPS de citas a domicilio\n- **Descubrimiento**: Bú\
    squeda geolocalizada de servicios\n- **Herramientas Clínicas**: Asistencia con\
    \ IA para diagnóstico y tratamiento\n- **WebSocket**: Actualizaciones en tiempo\
    \ real para juntas\n\n### Autenticación\n\nLa mayoría de los endpoints requieren\
    \ autenticación mediante JWT (JSON Web Token).\n\n**Flujo de autenticación:**\n\
    1. Obtener un Google ID Token desde el cliente\n2. Intercambiarlo por un JWT de\
    \ CliniPets usando `POST /api/auth/google`\n3. Incluir el JWT en el header `Authorization:\
    \ Bearer {token}` en cada petición\n\n/google-login.html\n\n### Roles de usuario\n\
    \n- **CLIENTE**: Dueños de mascotas (pueden gestionar mascotas y crear reservas)\n\
    - **VETERINARIO**: Profesionales veterinarios (gestión de agenda, juntas, herramientas\
    \ clínicas)\n- **ADMIN**: Administradores del sistema (acceso completo)\n\n###\
    \ WebSocket\n\nAdemás de la API REST, el sistema ofrece comunicación en tiempo\
    \ real vía WebSocket:\n- **Endpoint**: `ws://localhost:8080/ws`\n- **Protocolo**:\
    \ STOMP sobre WebSocket\n- **Destinos**: `/topic/juntas/{juntaId}` para seguimiento\
    \ de citas\n\n### Modelo de datos\n\nEl sistema sigue principios de Domain-Driven\
    \ Design (DDD) con contextos delimitados:\n- **Identidad**: Usuarios, roles y\
    \ autenticación\n- **Mascotas**: Gestión de mascotas y sus datos\n- **Catálogo**:\
    \ Procedimientos y ofertas\n- **Agenda**: Reservas, disponibilidad y juntas\n\
    - **Veterinarios**: Perfil y gestión de veterinarios\n- **Descubrimiento**: Bú\
    squeda y exploración\n- **Clínica**: Herramientas profesionales\n\n### Versionamiento\n\
    \nLa API utiliza versionamiento semántico. La versión actual es **1.0.0**.\n\n\
    ### Códigos de estado HTTP\n\n- **200 OK**: Petición exitosa\n- **201 Created**:\
    \ Recurso creado exitosamente\n- **204 No Content**: Operación exitosa sin contenido\
    \ de respuesta\n- **400 Bad Request**: Datos inválidos o petición malformada\n\
    - **401 Unauthorized**: No autenticado o token inválido\n- **403 Forbidden**:\
    \ Autenticado pero sin permisos suficientes\n- **404 Not Found**: Recurso no encontrado\n\
    - **500 Internal Server Error**: Error del servidor"
  contact:
    name: Equipo CliniPets
    url: https://clinipets.cl
    email: soporte@clinipets.cl
  license:
    name: Propietario
    url: https://clinipets.cl/licencia
  version: 1.0.0
servers:
  - url: http://localhost:8080
    description: Servidor de Desarrollo
  - url: https://api.clinipets.cl
    description: Servidor de Producción
security:
  - bearerAuth: []
tags:
  - name: Herramientas Clínicas
    description: Asistencia clínica inteligente para veterinarios (IA/ML)
  - name: Autenticación
    description: Endpoints de autenticación y gestión de sesión
  - name: Agenda
    description: Gestión de disponibilidad y reservas
  - name: Veterinarios
    description: "Gestión de veterinarios: registro, perfil y verificación"
  - name: Descubrimiento
    description: Búsqueda geo-localizada de servicios
  - name: Mascotas
    description: Gestión de mascotas del usuario
paths:
  /api/veterinarios/{id}/verificar:
    put:
      tags:
        - Veterinarios
      summary: Verificar cuenta de veterinario (ADMIN)
      operationId: verificar
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: OK
          content:
            '*/*':
              schema:
                $ref: "#/components/schemas/Veterinario"
  /api/veterinarios/mi-perfil:
    get:
      tags:
        - Veterinarios
      summary: Obtener mi perfil de veterinario
      operationId: miPerfil
      responses:
        "200":
          description: OK
          content:
            '*/*':
              schema:
                $ref: "#/components/schemas/Veterinario"
    put:
      tags:
        - Veterinarios
      summary: Actualizar mi perfil de veterinario
      operationId: actualizarMiPerfil
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ActualizarPerfilRequest"
        required: true
      responses:
        "200":
          description: OK
          content:
            '*/*':
              schema:
                $ref: "#/components/schemas/Veterinario"
  /api/veterinarios/mi-disponibilidad:
    get:
      tags:
        - Veterinarios
      summary: Consultar mi disponibilidad semanal
      operationId: miDisponibilidad
      responses:
        "200":
          description: OK
          content:
            '*/*':
              schema:
                $ref: "#/components/schemas/DisponibilidadSemanal"
    put:
      tags:
        - Veterinarios
      summary: Actualizar mi disponibilidad semanal (reemplazo completo)
      operationId: actualizarMiDisponibilidad
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ActualizarDisponibilidadRequest"
        required: true
      responses:
        "200":
          description: OK
          content:
            '*/*':
              schema:
                $ref: "#/components/schemas/DisponibilidadSemanal"
  /api/veterinarios/mi-catalogo:
    get:
      tags:
        - Veterinarios
      summary: Consultar mi catálogo de procedimientos
      operationId: miCatalogo
      responses:
        "200":
          description: OK
          content:
            '*/*':
              schema:
                $ref: "#/components/schemas/CatalogoVeterinarioResponse"
    put:
      tags:
        - Veterinarios
      summary: Reemplazar mi catálogo de procedimientos (pasar lista de ítems)
      operationId: actualizarMiCatalogo
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ActualizarCatalogoRequest"
        required: true
      responses:
        "200":
          description: OK
          content:
            '*/*':
              schema:
                $ref: "#/components/schemas/CatalogoVeterinarioResponse"
  /api/mascotas/{id}:
    get:
      tags:
        - Mascotas
      summary: Detalle de mascota
      description: "\n            Obtiene los detalles completos de una mascota por\
        \ su ID.\n            Solo accesible por el propietario o usuarios con rol\
        \ ADMIN.\n        "
      operationId: detalleMascota
      parameters:
        - name: id
          in: path
          description: UUID de la mascota
          required: true
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: Detalle obtenido exitosamente
          content:
            '*/*':
              schema:
                $ref: "#/components/schemas/Mascota"
        "403":
          description: Acceso denegado - no es el propietario
          content:
            '*/*':
              schema:
                $ref: "#/components/schemas/ProblemDetail"
        "404":
          description: Mascota no encontrada
          content:
            '*/*':
              schema:
                $ref: "#/components/schemas/ProblemDetail"
      security:
        - bearerAuth: []
    put:
      tags:
        - Mascotas
      summary: Actualizar datos de mascota
      description: "Actualiza información básica de la mascota (nombre, raza, peso,\
        \ etc.)."
      operationId: actualizarMascota
      parameters:
        - name: id
          in: path
          description: UUID de la mascota
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ActualizarMascota"
        required: true
      responses:
        "200":
          description: Mascota actualizada exitosamente
          content:
            '*/*':
              schema:
                $ref: "#/components/schemas/Mascota"
        "403":
          description: Acceso denegado - no es el propietario
          content:
            '*/*':
              schema:
                $ref: "#/components/schemas/ProblemDetail"
        "404":
          description: Mascota no encontrada
          content:
            '*/*':
              schema:
                $ref: "#/components/schemas/ProblemDetail"
      security:
        - bearerAuth: []
    delete:
      tags:
        - Mascotas
      summary: Eliminar mascota
      description: Elimina una mascota del sistema. Solo el propietario puede realizar
        esta acción.
      operationId: eliminarMascota
      parameters:
        - name: id
          in: path
          description: UUID de la mascota
          required: true
          schema:
            type: string
            format: uuid
      responses:
        "204":
          description: Mascota eliminada exitosamente
        "403":
          description: Acceso denegado - no es el propietario
          content:
            '*/*':
              schema:
                $ref: "#/components/schemas/ProblemDetail"
        "404":
          description: Mascota no encontrada
          content:
            '*/*':
              schema:
                $ref: "#/components/schemas/ProblemDetail"
      security:
        - bearerAuth: []
  /api/agenda/reservas/{reservaId}/confirmar:
    put:
      tags:
        - Agenda
      summary: "[Flujo 1] Confirmar reserva de clínica (Veterinario)"
      description: El veterinario aprueba una reserva PENDIENTE (del Flujo 1) y la
        cambia a CONFIRMADA.
      operationId: confirmarReservaClinica
      parameters:
        - name: reservaId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: OK
          content:
            '*/*':
              schema:
                $ref: "#/components/schemas/ReservaDto"
      security:
        - bearerAuth: []
  /api/veterinarios:
    post:
      tags:
        - Veterinarios
      summary: Registrar/activar cuenta de veterinario (onboarding)
      operationId: registrar
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/RegistrarVeterinarioRequest"
        required: true
      responses:
        "200":
          description: OK
          content:
            '*/*':
              schema:
                $ref: "#/components/schemas/Veterinario"
  /api/mascotas:
    post:
      tags:
        - Mascotas
      summary: Registrar nueva mascota
      description: "\n            Crea una nueva mascota asociada al usuario autenticado.\n\
        \            La mascota incluye información como nombre, especie, raza, fecha\
        \ de nacimiento, etc.\n        "
      operationId: crearMascota
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CrearMascota"
        required: true
      responses:
        "201":
          description: Mascota creada exitosamente
          content:
            '*/*':
              schema:
                $ref: "#/components/schemas/Mascota"
        "400":
          description: Datos inválidos
          content:
            '*/*':
              schema:
                $ref: "#/components/schemas/ProblemDetail"
        "401":
          description: No autenticado
          content:
            '*/*':
              schema:
                $ref: "#/components/schemas/ProblemDetail"
      security:
        - bearerAuth: []
  /api/mascotas/razas:
    post:
      tags:
        - Mascotas
      summary: Buscar razas
      description: "Devuelve una lista de razas, filtrada por los criterios del cuerpo\
        \ JSON."
      operationId: buscarRazas
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ListarRazasRequest"
        required: true
      responses:
        "200":
          description: Lista de razas obtenida exitosamente
          content:
            '*/*':
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Raza"
      security:
        - bearerAuth: []
  /api/descubrimiento/buscar:
    post:
      tags:
        - Descubrimiento
      summary: Buscar veterinarios por servicio y ubicación
      description: "\n            Realiza una búsqueda filtrada de veterinarios.\n\
        \            1. Filtra por compatibilidad de servicio y especie.\n       \
        \     2. Filtra por modo de atención (Domicilio o Clínica).\n            3.\
        \ Filtra geográficamente (radio de cobertura o cercanía).\n        "
      operationId: buscarDescubrimiento
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/DiscoveryRequest"
        required: true
      responses:
        "200":
          description: OK
          content:
            '*/*':
              schema:
                type: object
      security:
        - bearerAuth: []
  /api/clinica/sugerencias/tratamiento:
    post:
      tags:
        - Herramientas Clínicas
      summary: Obtener recomendaciones de tratamiento
      description: "\n            Proporciona recomendaciones de tratamiento para\
        \ un diagnóstico específico.\n            Incluye sugerencias de medicació\
        n, procedimientos y cuidados.\n            \n            **Requiere rol:**\
        \ VETERINARIO o ADMIN\n            \n            **Nota:** Esta es una herramienta\
        \ de asistencia. El plan de tratamiento final es responsabilidad del veterinario.\n\
        \        "
      operationId: obtenerRecomendacionesTratamiento
      requestBody:
        description: Diagnóstico establecido
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/RecomendacionesTratamientoRequest"
            example:
              diagnostico: Gastroenteritis aguda
        required: true
      responses:
        "200":
          description: Recomendaciones generadas exitosamente
          content:
            application/json:
              example:
                - Fluidoterapia
                - Dieta blanda
                - Antiemético (Metoclopramida)
                - Protector gástrico
        "400":
          description: Diagnóstico vacío o inválido
          content:
            '*/*':
              schema:
                type: array
                items:
                  type: string
        "403":
          description: Sin permisos - requiere rol VETERINARIO o ADMIN
          content:
            '*/*':
              schema:
                type: array
                items:
                  type: string
      security:
        - bearerAuth: []
  /api/clinica/sugerencias/diagnostico:
    post:
      tags:
        - Herramientas Clínicas
      summary: Obtener sugerencias de diagnóstico
      description: "\n            Proporciona sugerencias de diagnósticos posibles\
        \ basados en una lista de síntomas observados.\n            Utiliza modelos\
        \ de IA/ML para asistir al veterinario (no reemplaza el criterio profesional).\n\
        \            \n            **Requiere rol:** VETERINARIO o ADMIN\n       \
        \     \n            **Nota:** Esta es una herramienta de asistencia. El diagnó\
        stico final es responsabilidad del veterinario.\n        "
      operationId: obtenerSugerenciasDiagnostico
      requestBody:
        description: Síntomas observados en el paciente
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/SugerenciasDiagnosticoRequest"
            example:
              sintomas:
                - fiebre
                - tos
                - estornudos
                - secreción nasal
        required: true
      responses:
        "200":
          description: Sugerencias generadas exitosamente
          content:
            application/json:
              example:
                - Infección respiratoria superior
                - Tos de las perreras
                - Influenza canina
        "400":
          description: Lista de síntomas vacía o inválida
          content:
            '*/*':
              schema:
                type: array
                items:
                  type: string
        "403":
          description: Sin permisos - requiere rol VETERINARIO o ADMIN
          content:
            '*/*':
              schema:
                type: array
                items:
                  type: string
      security:
        - bearerAuth: []
  /api/auth/refresh:
    post:
      tags:
        - Autenticación
      summary: Refrescar sesión
      description: Lee el refresh token de la cookie HttpOnly y entrega un nuevo access
        token (y rota el refresh).
      operationId: authRefresh
      responses:
        "200":
          description: Token rotado correctamente
          content:
            '*/*':
              schema:
                $ref: "#/components/schemas/RefreshResponse"
        "401":
          description: "Refresh token ausente, inválido o expirado"
          content:
            '*/*':
              schema:
                $ref: "#/components/schemas/ErrorResponse"
      security:
        - bearerAuth: []
  /api/auth/logout:
    post:
      tags:
        - Autenticación
      summary: Cerrar sesión
      description: Elimina la cookie de refresh y cierra la sesión en el cliente.
      operationId: authLogout
      responses:
        "200":
          description: Sesión cerrada correctamente
          content:
            '*/*':
              schema:
                type: object
                additionalProperties: {}
  /api/auth/google:
    post:
      tags:
        - Autenticación
      summary: Autenticación con Google
      description: "\n            Autentica un usuario mediante Google Sign-In. \n\
        \            Intercambia un Google ID Token válido por un JWT propio del sistema.\n\
        \            Si el usuario no existe, se crea automáticamente.\n         \
        \   También emite un refresh token en cookie HttpOnly.\n        "
      operationId: authLoginGoogle
      requestBody:
        description: Token de Google emitido por el cliente
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/GoogleLoginRequest"
            examples:
              LoginGoogle:
                summary: Petición con ID Token válido
                description: LoginGoogle
                value:
                  idToken: eyJhbGciOiJSUzI1NiIsImtpZCI6...
        required: true
      responses:
        "200":
          description: Autenticación exitosa
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/LoginResponse"
        "400":
          description: Token mal formado
          content:
            '*/*':
              schema:
                $ref: "#/components/schemas/ProblemDetail"
        "401":
          description: Token de Google inválido o expirado
          content:
            '*/*':
              schema:
                $ref: "#/components/schemas/ProblemDetail"
  /api/agenda/solicitudes:
    post:
      tags:
        - Agenda
      summary: "[Flujo 2] Cliente publica una solicitud de servicio (Licitación)"
      description: "Crea una 'oferta pública' para servicios a domicilio o con logí\
        stica, esperando ofertas de veterinarios."
      operationId: crearSolicitudServicio
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CrearSolicitudRequest"
        required: true
      responses:
        "201":
          description: Created
          content:
            '*/*':
              schema:
                type: object
      security:
        - bearerAuth: []
  /api/agenda/solicitudes/{solicitudId}/ofertar:
    post:
      tags:
        - Agenda
      summary: "[Flujo 2] Veterinario hace una oferta (puja)"
      description: Un veterinario envía una propuesta de precio y hora para una solicitud
        abierta.
      operationId: crearOferta
      parameters:
        - name: solicitudId
          in: path
          description: ID de la Solicitud a la que se oferta
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CrearOfertaRequest"
        required: true
      responses:
        "201":
          description: Created
          content:
            '*/*':
              schema:
                type: object
      security:
        - bearerAuth: []
  /api/agenda/ofertas/{ofertaId}/aceptar:
    post:
      tags:
        - Agenda
      summary: "[Flujo 2] Cliente acepta una oferta"
      description: El cliente acepta la puja de un veterinario. Esto cierra la solicitud
        y crea la(s) Reserva(s) en estado CONFIRMADA.
      operationId: aceptarOferta
      parameters:
        - name: ofertaId
          in: path
          description: ID de la Oferta (puja) que se está aceptando
          required: true
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: OK
          content:
            '*/*':
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/ReservaDto"
      security:
        - bearerAuth: []
  /api/agenda/clinica/reservar:
    post:
      tags:
        - Agenda
      summary: "[Flujo 1] Reservar un slot de clínica (Cliente)"
      description: Un cliente reserva un slot de clínica. La reserva se crea en estado
        PENDIENTE.
      operationId: crearReservaClinica
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ReservarSlotClinicaRequest"
        required: true
      responses:
        "201":
          description: Created
          content:
            '*/*':
              schema:
                $ref: "#/components/schemas/ReservaDto"
      security:
        - bearerAuth: []
  /api/veterinarios/procedimientos:
    get:
      tags:
        - Veterinarios
      summary: Listar procedimientos disponibles para catálogo
      operationId: listarProcedimientos
      responses:
        "200":
          description: OK
          content:
            '*/*':
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Procedimiento"
  /api/mascotas/mias:
    get:
      tags:
        - Mascotas
      summary: Listar mis mascotas
      description: Devuelve todas las mascotas registradas del usuario autenticado.
      operationId: listarMisMascotas
      responses:
        "200":
          description: Lista de mascotas obtenida exitosamente
          content:
            '*/*':
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Mascota"
        "401":
          description: No autenticado
          content:
            '*/*':
              schema:
                $ref: "#/components/schemas/ProblemDetail"
      security:
        - bearerAuth: []
  /api/auth/me:
    get:
      tags:
        - Autenticación
      summary: Obtener perfil actual
      description: "\n            Devuelve información básica del usuario autenticado.\n\
        \            Si no hay token o es inválido, devuelve authenticated=false.\n\
        \        "
      operationId: authMe
      responses:
        "200":
          description: Perfil obtenido exitosamente
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/MeResponse"
      security:
        - bearerAuth: []
  /api/agenda/solicitudes/disponibles:
    get:
      tags:
        - Agenda
      summary: "[Flujo 2] Veterinario ve solicitudes abiertas (Jobs)"
      description: "Obtiene una lista de solicitudes de clientes que el veterinario\
        \ logueado puede atender (basado en geografía, catálogo y logística)."
      operationId: getSolicitudesDisponibles
      responses:
        "200":
          description: OK
          content:
            '*/*':
              schema:
                type: object
      security:
        - bearerAuth: []
  /api/agenda/clinica/{vetId}/disponibilidad:
    get:
      tags:
        - Agenda
      summary: "[Flujo 1] Obtener slots de clínica"
      description: "Calcula y devuelve los slots de horario exactos para un servicio\
        \ en la clínica de un veterinario, en una fecha específica."
      operationId: getSlotsDisponiblesClinica
      parameters:
        - name: vetId
          in: path
          description: ID del Veterinario
          required: true
          schema:
            type: string
            format: uuid
        - name: fecha
          in: query
          description: Fecha de la consulta (YYYY-MM-DD)
          required: true
          schema:
            type: string
            format: date
        - name: servicioSku
          in: query
          description: SKU del procedimiento a realizar
          required: true
          schema:
            type: string
      responses:
        "200":
          description: OK
          content:
            '*/*':
              schema:
                $ref: "#/components/schemas/SlotsDisponiblesResponse"
      security:
        - bearerAuth: []
components:
  schemas:
    Veterinario:
      type: object
      properties:
        id:
          type: string
          format: uuid
        nombreCompleto:
          type: string
        numeroLicencia:
          type: string
        estado:
          type: string
          enum:
            - ONLINE
            - OCUPADO
            - OFFLINE
        modosAtencion:
          type: array
          items:
            type: string
            enum:
              - DOMICILIO
              - CLINICA
              - URGENCIA
          uniqueItems: true
        latitud:
          type: number
          format: double
        longitud:
          type: number
          format: double
        radioCobertura:
          type: number
          format: double
        verificado:
          type: boolean
        ofreceLogistica:
          type: boolean
        creadoEn:
          type: string
          format: date-time
        modificadoEn:
          type: string
          format: date-time
        creadoPor:
          type: string
          format: uuid
        modificadoPor:
          type: string
          format: uuid
      required:
        - creadoEn
        - estado
        - modificadoEn
        - modosAtencion
        - nombreCompleto
        - ofreceLogistica
        - verificado
    ActualizarPerfilRequest:
      type: object
      properties:
        nombreCompleto:
          type: string
        numeroLicencia:
          type: string
        modosAtencion:
          type: array
          items:
            type: string
            enum:
              - DOMICILIO
              - CLINICA
              - URGENCIA
          uniqueItems: true
        latitud:
          type: number
          format: double
        longitud:
          type: number
          format: double
        radioCobertura:
          type: number
          format: double
    ActualizarDisponibilidadRequest:
      type: object
      properties:
        bloques:
          type: array
          items:
            $ref: "#/components/schemas/BloqueHorarioDto"
      required:
        - bloques
    BloqueHorarioDto:
      type: object
      properties:
        dia:
          type: string
          enum:
            - MONDAY
            - TUESDAY
            - WEDNESDAY
            - THURSDAY
            - FRIDAY
            - SATURDAY
            - SUNDAY
        inicio:
          type: string
        fin:
          type: string
        habilitado:
          type: boolean
      required:
        - dia
        - fin
        - habilitado
        - inicio
    BloqueHorario:
      type: object
      properties:
        dia:
          type: string
          enum:
            - MONDAY
            - TUESDAY
            - WEDNESDAY
            - THURSDAY
            - FRIDAY
            - SATURDAY
            - SUNDAY
        inicio:
          type: string
        fin:
          type: string
        habilitado:
          type: boolean
      required:
        - dia
        - fin
        - habilitado
        - inicio
    DisponibilidadSemanal:
      type: object
      properties:
        bloques:
          type: array
          items:
            $ref: "#/components/schemas/BloqueHorario"
        creadoEn:
          type: string
          format: date-time
        modificadoEn:
          type: string
          format: date-time
        creadoPor:
          type: string
          format: uuid
        modificadoPor:
          type: string
          format: uuid
      required:
        - bloques
        - creadoEn
        - modificadoEn
    ActualizarCatalogoRequest:
      type: object
      properties:
        items:
          type: array
          items:
            $ref: "#/components/schemas/CatalogoItemRequest"
      required:
        - items
    CatalogoItemRequest:
      type: object
      properties:
        sku:
          type: string
        habilitado:
          type: boolean
        duracionMinutosOverride:
          type: integer
          format: int32
        precioOverride:
          type: integer
          format: int32
      required:
        - habilitado
        - sku
    CatalogoVeterinarioResponse:
      type: object
      properties:
        id:
          type: string
          format: uuid
        creadoEn:
          type: string
          format: date-time
        modificadoEn:
          type: string
          format: date-time
        items:
          type: array
          items:
            $ref: "#/components/schemas/ItemCatalogoResponse"
      required:
        - creadoEn
        - items
        - modificadoEn
    ItemCatalogoResponse:
      type: object
      properties:
        sku:
          type: string
        nombre:
          type: string
        descripcion:
          type: string
        habilitado:
          type: boolean
        precioOverride:
          type: integer
          format: int32
        precio:
          type: integer
          format: int32
        duracionMinutos:
          type: integer
          format: int32
        duracionMinutosOverride:
          type: integer
          format: int32
        compatibleCon:
          type: array
          items:
            type: string
            enum:
              - PERRO
              - GATO
          uniqueItems: true
      required:
        - compatibleCon
        - duracionMinutos
        - habilitado
        - nombre
        - precio
        - sku
    ActualizarMascota:
      type: object
      properties:
        nombre:
          type: string
        razaId:
          type: string
          format: uuid
        sexo:
          type: string
          enum:
            - MACHO
            - HEMBRA
            - INDETERMINADO
        fechaNacimiento:
          type: string
          format: date
        esFechaAproximada:
          type: boolean
        pesoKg:
          type: number
          format: double
        pelaje:
          type: string
          enum:
            - CORTO
            - MEDIO
            - LARGO
            - RIZADO
            - SIN_PELO
        patron:
          type: string
          enum:
            - SOLIDO
            - BICOLOR
            - TRICOLOR
            - TABBY
            - MANCHAS_MERLE
            - ATIGRADO_BRINDLE
        colores:
          type: array
          items:
            type: string
            enum:
              - NEGRO
              - BLANCO
              - GRIS
              - NARANJA_ROJIZO
              - CREMA
              - CAFE_CHOCOLATE
              - AZUL
              - DORADO
              - FUEGO_TAN
          uniqueItems: true
    ProblemDetail:
      type: object
      properties:
        type:
          type: string
          format: uri
        title:
          type: string
        status:
          type: integer
          format: int32
        detail:
          type: string
        instance:
          type: string
          format: uri
        properties:
          type: object
          additionalProperties: {}
    Mascota:
      type: object
      properties:
        id:
          type: string
          format: uuid
        nombre:
          type: string
        especie:
          type: string
          enum:
            - PERRO
            - GATO
        raza:
          $ref: "#/components/schemas/Raza"
        sexo:
          type: string
          enum:
            - MACHO
            - HEMBRA
            - INDETERMINADO
        fechaNacimiento:
          type: string
          format: date
        esFechaAproximada:
          type: boolean
        pesoKg:
          type: number
          format: double
        pelaje:
          type: string
          enum:
            - CORTO
            - MEDIO
            - LARGO
            - RIZADO
            - SIN_PELO
        patron:
          type: string
          enum:
            - SOLIDO
            - BICOLOR
            - TRICOLOR
            - TABBY
            - MANCHAS_MERLE
            - ATIGRADO_BRINDLE
        colores:
          type: array
          items:
            type: string
            enum:
              - NEGRO
              - BLANCO
              - GRIS
              - NARANJA_ROJIZO
              - CREMA
              - CAFE_CHOCOLATE
              - AZUL
              - DORADO
              - FUEGO_TAN
          uniqueItems: true
        creadoEn:
          type: string
          format: date-time
        modificadoEn:
          type: string
          format: date-time
        creadoPor:
          type: string
          format: uuid
        modificadoPor:
          type: string
          format: uuid
      required:
        - colores
        - creadoEn
        - esFechaAproximada
        - especie
        - modificadoEn
        - nombre
    Raza:
      type: object
      properties:
        id:
          type: string
          format: uuid
        nombre:
          type: string
        especie:
          type: string
          enum:
            - PERRO
            - GATO
      required:
        - especie
        - nombre
    InfoMascotaDto:
      type: object
      properties:
        id:
          type: string
          format: uuid
        nombre:
          type: string
        especie:
          type: string
          enum:
            - PERRO
            - GATO
      required:
        - especie
        - id
        - nombre
    InfoProcedimientoDto:
      type: object
      properties:
        sku:
          type: string
        nombre:
          type: string
      required:
        - nombre
        - sku
    InfoUsuarioDto:
      type: object
      properties:
        id:
          type: string
          format: uuid
        nombreCompleto:
          type: string
      required:
        - id
        - nombreCompleto
    ReservaDto:
      type: object
      properties:
        id:
          type: string
          format: uuid
        fecha:
          type: string
          format: date
        horaInicio:
          type: string
        horaFin:
          type: string
        estado:
          type: string
          enum:
            - PENDIENTE
            - CONFIRMADA
            - CANCELADA_CLIENTE
            - CANCELADA_VET
            - COMPLETADA
            - EN_CURSO
            - NO_ASISTIO
        tipo:
          type: string
          enum:
            - CITA_SIMPLE
            - RETIRO
            - PROCEDIMIENTO_CLINICA
            - ENTREGA
        modoAtencion:
          type: string
          enum:
            - DOMICILIO
            - CLINICA
            - URGENCIA
        precio:
          type: integer
          format: int32
        veterinario:
          $ref: "#/components/schemas/InfoUsuarioDto"
        cliente:
          $ref: "#/components/schemas/InfoUsuarioDto"
        mascota:
          $ref: "#/components/schemas/InfoMascotaDto"
        procedimiento:
          $ref: "#/components/schemas/InfoProcedimientoDto"
      required:
        - cliente
        - estado
        - fecha
        - horaFin
        - horaInicio
        - id
        - mascota
        - modoAtencion
        - precio
        - procedimiento
        - tipo
        - veterinario
    RegistrarVeterinarioRequest:
      type: object
      properties:
        nombreCompleto:
          type: string
        numeroLicencia:
          type: string
        modosAtencion:
          type: array
          items:
            type: string
            enum:
              - DOMICILIO
              - CLINICA
              - URGENCIA
          uniqueItems: true
        latitud:
          type: number
          format: double
        longitud:
          type: number
          format: double
        radioCobertura:
          type: number
          format: double
      required:
        - nombreCompleto
    CrearMascota:
      type: object
      properties:
        nombre:
          type: string
        especie:
          type: string
          enum:
            - PERRO
            - GATO
        razaId:
          type: string
          format: uuid
        sexo:
          type: string
          enum:
            - MACHO
            - HEMBRA
            - INDETERMINADO
        fechaNacimiento:
          type: string
          format: date
        esFechaAproximada:
          type: boolean
        pesoKg:
          type: number
          format: double
        pelaje:
          type: string
          enum:
            - CORTO
            - MEDIO
            - LARGO
            - RIZADO
            - SIN_PELO
        patron:
          type: string
          enum:
            - SOLIDO
            - BICOLOR
            - TRICOLOR
            - TABBY
            - MANCHAS_MERLE
            - ATIGRADO_BRINDLE
        colores:
          type: array
          items:
            type: string
            enum:
              - NEGRO
              - BLANCO
              - GRIS
              - NARANJA_ROJIZO
              - CREMA
              - CAFE_CHOCOLATE
              - AZUL
              - DORADO
              - FUEGO_TAN
          uniqueItems: true
      required:
        - especie
        - nombre
    ListarRazasRequest:
      type: object
      properties:
        especie:
          type: string
          enum:
            - PERRO
            - GATO
    DiscoveryRequest:
      type: object
      properties:
        mascotaId:
          type: string
          format: uuid
        servicioSku:
          type: string
        modoAtencion:
          type: string
          enum:
            - DOMICILIO
            - CLINICA
            - URGENCIA
        ubicacionUsuario:
          $ref: "#/components/schemas/UbicacionDto"
      required:
        - mascotaId
        - modoAtencion
        - servicioSku
        - ubicacionUsuario
    UbicacionDto:
      type: object
      properties:
        latitud:
          type: number
          format: double
        longitud:
          type: number
          format: double
      required:
        - latitud
        - longitud
    RecomendacionesTratamientoRequest:
      type: object
      description: Solicitud de recomendaciones de tratamiento para un diagnóstico
      properties:
        diagnostico:
          type: string
          description: Diagnóstico establecido
          example: Gastroenteritis aguda
      required:
        - diagnostico
    SugerenciasDiagnosticoRequest:
      type: object
      description: Solicitud de sugerencias de diagnóstico basadas en síntomas
      properties:
        sintomas:
          type: array
          description: Lista de síntomas observados
          example:
            - fiebre
            - vómitos
            - letargo
          items:
            type: string
      required:
        - sintomas
    RefreshResponse:
      type: object
      description: Respuesta tras rotar el token de acceso.
      properties:
        token:
          type: string
          description: Nuevo JWT de acceso
        expiresAt:
          type: string
          format: date-time
          description: Expiración del nuevo JWT de acceso
        usuario:
          $ref: "#/components/schemas/UsuarioInfo"
          description: Perfil del usuario autenticado
      required:
        - expiresAt
        - token
        - usuario
    UsuarioInfo:
      type: object
      description: Información del usuario autenticado expuesta al cliente.
      properties:
        id:
          type: string
          format: uuid
          description: Identificador del usuario
        email:
          type: string
          format: email
          description: Email verificado del usuario
        nombre:
          type: string
          description: Nombre visible del usuario
        fotoUrl:
          type: string
          description: URL del avatar o foto del usuario
        roles:
          type: array
          description: Roles otorgados al usuario
          example:
            - CLIENTE
          items:
            type: string
      required:
        - email
        - id
        - roles
    ErrorResponse:
      type: object
      description: Respuesta estándar de error.
      properties:
        error:
          type: string
          description: Mensaje legible del error
      required:
        - error
    GoogleLoginRequest:
      type: object
      description: Payload enviado por el cliente móvil luego de autenticarse con
        Google Sign-In.
      example:
        idToken: eyJhbGciOiJSUzI1NiIsImtpZCI6InNvbWUta2V5In0...
      properties:
        idToken:
          type: string
          description: ID Token de Google con email verificado
      required:
        - idToken
    LoginResponse:
      type: object
      description: Respuesta devuelta tras un login exitoso.
      properties:
        token:
          type: string
          description: JWT de acceso emitido por el backend
        expiresAt:
          type: string
          format: date-time
          description: Expiración del JWT de acceso
        refreshExpiresAt:
          type: string
          format: date-time
          description: Expiración del refresh token
        usuario:
          $ref: "#/components/schemas/UsuarioInfo"
          description: Perfil del usuario autenticado
      required:
        - expiresAt
        - token
        - usuario
    CrearSolicitudRequest:
      type: object
      properties:
        mascotaId:
          type: string
          format: uuid
        procedimientoSku:
          type: string
        modoAtencion:
          type: string
          enum:
            - DOMICILIO
            - CLINICA
            - URGENCIA
        preferenciaLogistica:
          type: string
          enum:
            - YO_LLEVO
            - RETIRO_Y_ENTREGA
        fecha:
          type: string
          format: date
        bloqueSolicitado:
          type: string
          enum:
            - MANANA
            - TARDE
        latitud:
          type: number
          format: double
        longitud:
          type: number
          format: double
      required:
        - bloqueSolicitado
        - fecha
        - latitud
        - longitud
        - mascotaId
        - modoAtencion
        - preferenciaLogistica
        - procedimientoSku
    CrearOfertaRequest:
      type: object
      properties:
        precioServicio:
          type: integer
          format: int32
        precioLogistica:
          type: integer
          format: int32
        horaRetiroPropuesta:
          type: string
        horaCirugiaPropuesta:
          type: string
        horaEntregaEstimada:
          type: string
      required:
        - horaCirugiaPropuesta
        - precioLogistica
        - precioServicio
    ReservarSlotClinicaRequest:
      type: object
      properties:
        veterinarioId:
          type: string
          format: uuid
        mascotaId:
          type: string
          format: uuid
        procedimientoSku:
          type: string
        fecha:
          type: string
          format: date
        horaInicio:
          type: string
      required:
        - fecha
        - horaInicio
        - mascotaId
        - procedimientoSku
        - veterinarioId
    Procedimiento:
      type: object
      properties:
        sku:
          type: string
        nombre:
          type: string
        descripcion:
          type: string
        precio:
          type: integer
          format: int32
        compatibleCon:
          type: array
          items:
            type: string
            enum:
              - PERRO
              - GATO
          uniqueItems: true
        modosHabilitados:
          type: array
          items:
            type: string
            enum:
              - DOMICILIO
              - CLINICA
              - URGENCIA
          uniqueItems: true
        flujo:
          type: string
          enum:
            - SIMPLE
            - LOGISTICA_COMPLETA
        duracionMinutos:
          type: integer
          format: int32
        creadoEn:
          type: string
          format: date-time
        modificadoEn:
          type: string
          format: date-time
        creadoPor:
          type: string
          format: uuid
        modificadoPor:
          type: string
          format: uuid
      required:
        - compatibleCon
        - creadoEn
        - duracionMinutos
        - flujo
        - modificadoEn
        - modosHabilitados
        - nombre
        - precio
        - sku
    MeResponse:
      type: object
      description: Respuesta al consultar el perfil actual.
      properties:
        authenticated:
          type: boolean
          description: Indica si existe una sesión autenticada
        id:
          type: string
          format: uuid
          description: Identificador del usuario autenticado
        email:
          type: string
          description: Email asociado a la sesión
        roles:
          type: array
          description: Roles activos del usuario
          items:
            type: string
        nombre:
          type: string
          description: Nombre visible del usuario
        fotoUrl:
          type: string
          description: URL del avatar o foto del usuario
      required:
        - authenticated
    SlotsDisponiblesResponse:
      type: object
      properties:
        fecha:
          type: string
          format: date
        slots:
          type: array
          items:
            type: string
      required:
        - fecha
        - slots
  securitySchemes:
    bearerAuth:
      type: http
      description: JWT obtenido mediante autenticación con Google
      scheme: bearer
      bearerFormat: JWT
